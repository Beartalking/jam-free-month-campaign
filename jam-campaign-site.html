<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JAM - 每天1分钟提升英语口语</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiByeD0iMTYiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xNiAyMCBRMTYgMTYgMjAgMTYgTDQ0IDE2IFE0OCAxNiA0OCAyMCBMNDggMzYgUTQ4IDQwIDQ0IDQwIEwzMiA0MCBMMJICA0OCAzMiA0MCBMJDAGNDAGIJQMTYGNDAMTYGNDAJWII0ZmlsbD0iIzAxNDdGRSIvPgo8dGV4dCB4PSIzMiIgeT0iMzQiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IndoaXRlIiBzdHlsZT0iZm9udC1mYW1pbHk6IC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgc2Fucy1zZXJpZjsgZm9udC13ZWlnaHQ6IDkwMDsgZm9udC1zaXplOiAxNHB4OyI+SkFNITwvdGV4dD4KPHN2Zz4K">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgwIiBoZWlnaHQ9IjE4MCIgdmlld0JveD0iMCAwIDE4MCAxODAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxODAiIGhlaWdodD0iMTgwIiByeD0iNDAiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik00MCA1NSBRNDAgNDUgNTAgNDUgTDEzMCA0NSBRMTQwIDQ1IDE0MCA1NSBMVQWIDA5NTBRMTQWIDA1NJEMTNBIDA1IEw5MCGRMJUMA8GyAMTM1IEM5MCGRMJUBA4MCEA1IFE0MQEWIDTAIDUNINTAgNDV6IiBmaWxsPSIjMDE0N0ZFIi8+Cjx0ZXh0IHg9IjkwIiB5PSI5NSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0id2hpdGUiIHN0eWxlPSJmb250LWZhbWlseTogLWFwcGxlLXN5c3RlbSwgQmxpbmtNYWNTeXN0ZW1Gb250LCBzYW5zLXNlcmlmOyBmb250LXdlaWdodDogOTAwOyBmb250LXNpemU6IDM2cHg7Ij5KQU0hPC90ZXh0Pgo8L3N2Zz4K">
    <meta name="theme-color" content="#0147FE">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: #F9FAF8;
            color: #1A1A1A;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Color palette from JAM app */
        :root {
            --jam-yellow: #FFCC00;
            --jam-blue: #0147FE;
            --jam-green: #61BA47;
            --jam-black: #1A1A1A;
            --jam-gray: #5C5C5C;
            --jam-light: #F9FAF8;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Page transitions */
        .page {
            display: none;
            animation: slideIn 0.4s ease-out;
        }

        .page.active {
            display: block;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Hero section */
        .hero {
            background: #FFCC00;
            border: 4px solid #1A1A1A;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
            box-shadow: 8px 8px 0 #1A1A1A;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .hero.has-custom-bg {
            padding: 0;
            background: none;
        }

        .hero-custom-image {
            display: block;
            width: 100%;
            height: 100%;
            min-height: 300px;
            object-fit: cover;
            border-radius: 16px;
        }

        .hero.has-custom-bg .hero-custom-image {
            display: block;
        }

        .hero.has-custom-bg .hero-default-content {
            display: none;
        }



        .hero-image {
            position: relative;
            z-index: 2;
            text-align: center;
            margin-bottom: 20px;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            text-align: center;
        }

        .hero h1 {
            font-size: 48px;
            font-weight: 900;
            margin-bottom: 10px;
            letter-spacing: -2px;
        }

        .hero p {
            font-size: 18px;
            font-weight: 500;
        }

        /* Description section */
        .description {
            background: white;
            border: 3px solid #1A1A1A;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 6px 6px 0 #5C5C5C;
        }

        .description h2 {
            font-size: 24px;
            margin-bottom: 15px;
            color: #1A1A1A;
        }

        .description p {
            color: #5C5C5C;
            line-height: 1.8;
        }

        /* Form styles */
        .form-container {
            background: white;
            border: 3px solid #1A1A1A;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 6px 6px 0 #1A1A1A;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            font-weight: 700;
            margin-bottom: 8px;
            color: #1A1A1A;
            font-size: 14px;
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        select,
        textarea {
            width: 100%;
            padding: 14px;
            border: 3px solid #1A1A1A;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            background: #F9FAF8;
            transition: all 0.2s;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            background: white;
            box-shadow: 4px 4px 0 #FFCC00;
            transform: translate(-2px, -2px);
        }

        select {
            cursor: pointer;
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* Checkbox styles */
        .checkbox-group {
            display: flex;
            align-items: start;
            gap: 12px;
            margin-bottom: 25px;
            padding: 20px;
            background: #F9FAF8;
            border: 2px solid #1A1A1A;
            border-radius: 8px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
            margin-top: 2px;
            cursor: pointer;
            accent-color: #0147FE;
        }

        .checkbox-group label {
            margin-bottom: 0;
            font-weight: 500;
            cursor: pointer;
        }

        /* Button styles */
        .submit-btn {
            width: 100%;
            padding: 18px;
            background: #FFCC00;
            border: 4px solid #1A1A1A;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 6px 6px 0 #1A1A1A;
            margin-top: 20px;
        }

        .submit-btn:hover {
            transform: translate(-2px, -2px);
            box-shadow: 8px 8px 0 #1A1A1A;
        }

        .submit-btn:active {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 #1A1A1A;
        }

        /* Contract page styles */
        .contract-box {
            background: white;
            border: 4px solid #1A1A1A;
            border-radius: 16px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 8px 8px 0 #5C5C5C;
            position: relative;
            overflow: hidden;
        }

        /* Confetti effects */
        .confetti {
            position: absolute;
            width: 8px;
            height: 8px;
            animation: confetti-fall 3s linear infinite;
        }

        .confetti:nth-child(1) { left: 10%; animation-delay: 0s; background: #FFCC00; }
        .confetti:nth-child(2) { left: 20%; animation-delay: 0.5s; background: #0147FE; }
        .confetti:nth-child(3) { left: 30%; animation-delay: 1s; background: #61BA47; }
        .confetti:nth-child(4) { left: 40%; animation-delay: 1.5s; background: #FF3B30; }
        .confetti:nth-child(5) { left: 50%; animation-delay: 2s; background: #FFCC00; }
        .confetti:nth-child(6) { left: 60%; animation-delay: 0.8s; background: #0147FE; }
        .confetti:nth-child(7) { left: 70%; animation-delay: 1.3s; background: #61BA47; }
        .confetti:nth-child(8) { left: 80%; animation-delay: 0.3s; background: #FF3B30; }
        .confetti:nth-child(9) { left: 90%; animation-delay: 1.8s; background: #FFCC00; }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(400px) rotate(360deg);
                opacity: 0;
            }
        }

        .celebration-icon {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 24px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        .contract-title {
            font-size: 28px;
            font-weight: 900;
            margin-bottom: 20px;
            text-align: center;
        }

        .contract-content {
            font-size: 16px;
            line-height: 2;
            color: #1A1A1A;
            margin-bottom: 30px;
        }

        .highlight {
            background: #FFCC00;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 700;
        }

        .divider {
            width: 100%;
            height: 3px;
            background: #1A1A1A;
            margin: 30px 0;
        }

        /* Redeem code section */
        .redeem-section {
            background: #61BA47;
            border: 4px solid #1A1A1A;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 8px 8px 0 #1A1A1A;
            text-align: center;
        }

        .redeem-code {
            font-size: 24px;
            font-weight: 900;
            letter-spacing: 2px;
            margin: 20px 0;
            padding: 20px;
            background: white;
            border: 3px solid #1A1A1A;
            border-radius: 8px;
            word-break: break-all;
        }

        .redeem-link {
            display: inline-block;
            padding: 14px 28px;
            background: #0147FE;
            color: white;
            text-decoration: none;
            border: 3px solid #1A1A1A;
            border-radius: 8px;
            font-weight: 700;
            margin-top: 15px;
            transition: all 0.2s;
            box-shadow: 4px 4px 0 #1A1A1A;
        }

        .redeem-link:hover {
            transform: translate(-2px, -2px);
            box-shadow: 6px 6px 0 #1A1A1A;
        }

        /* Customer Service WeChat QR Code */
        .cs-qr-section {
            display: flex;
            justify-content: center;
            margin-top: 40px;
        }

        .cs-qr-box {
            text-align: center;
            max-width: 300px;
        }

        .cs-qr-card {
            background: white;
            border: 3px solid #1A1A1A;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 4px 4px 0 #1A1A1A;
            margin-bottom: 15px;
        }

        .cs-qr-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .cs-avatar-placeholder {
            width: 40px;
            height: 40px;
            background: #61BA47;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .cs-qr-code-display {
            display: flex;
            justify-content: center;
            align-items: center;
            background: #F9FAF8;
            border-radius: 8px;
            padding: 15px;
            min-height: 280px;
        }

        .cs-qr-code-display img {
            width: 250px;
            height: 250px;
            border-radius: 4px;
            object-fit: contain;
            background: white;
        }

        .cs-qr-label {
            font-weight: 700;
            color: #1A1A1A;
            font-size: 16px;
        }



        /* Error message */
        .error-message {
            background: #FF3B30;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 600;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        /* Progress indicator */
        .progress-bar {
            background: white;
            border: 3px solid var(--jam-black);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 4px 4px 0 var(--jam-gray);
        }

        .progress-text {
            font-weight: 700;
            color: var(--jam-black);
            margin-bottom: 10px;
        }

        .progress-steps {
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        .step {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--jam-gray);
            border: 2px solid var(--jam-black);
        }

        .step.active {
            background: var(--jam-yellow);
        }

        .step.completed {
            background: var(--jam-green);
        }

        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }

            .hero {
                padding: 30px 20px;
            }
            
            .hero h1 {
                font-size: 36px;
            }


            


            .form-container, .description, .contract-box, .redeem-section {
                padding: 20px;
            }
            
            .cs-qr-card {
                padding: 15px;
            }
            
            .cs-qr-code-display {
                padding: 10px;
                min-height: 200px;
            }
            
            .cs-qr-code-display img {
                width: 180px;
                height: 180px;
            }

            .submit-btn {
                font-size: 16px;
                padding: 16px;
            }
        }
    </style>
</head>
<body>
    <!-- Page 1: Form -->
    <div class="page active" id="page1">
        <div class="container">
            <div class="progress-bar">
                <div class="progress-text">Step 1 - Fill the info</div>
                <div class="progress-steps">
                    <div class="step active"></div>
                    <div class="step"></div>
                </div>
            </div>
            <div class="hero">
                <!-- Custom Image (now shown by default) -->
                <img class="hero-custom-image" alt="JAM Personal Speaking Coach" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDYwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI2MDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjQjNEQ0ZGIi8+CjxjaXJjbGUgY3g9IjEwMCIgY3k9IjgwIiByPSI0MCIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTgwIiBjeT0iNjAiIHI9IjMwIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIzMDAiIGN5PSI5MCIgcj0iMjUiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjQwMCIgY3k9IjEwMCIgcj0iMzUiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjUwMCIgY3k9IjcwIiByPSIyMCIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTAgMjAwIEw2MDAgMjAwIEw2MDAgMzAwIEwwIDMwMCBaIiBmaWxsPSIjOTlDQzMzIi8+CjxwYXRoIGQ9Ik0wIDIwMCBRMTUwIDE4MCAzMDAgMjAwIFE0NTAgMjIwIDYwMCAyMDAiIGZpbGw9IiM5OENDMzMiLz4KPHJlY3QgeD0iNDAiIHk9IjE2MCIgd2lkdGg9IjgwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI0Y0QjM3NyIvPgo8Y2lyY2xlIGN4PSI4MCIgY3k9IjE4MCIgcj0iMjAiIGZpbGw9IiMzMzMiLz4KPHBhdGggZD0iTTYwIDE5MCBRNjAgMTgwIDcwIDE4MCBMOTAgMTgwIFE5MCAxOTAgODAgMTkwIiBmaWxsPSIjMzMzIi8+CjxwYXRoIGQ9Ik02NSAxOTUgTDc1IDE5NSBNNzAgMTkwIEw3MCAyMDAiIHN0cm9rZT0iIzMzMyIgc3Ryb2tlLXdpZHRoPSIyIi8+CjxwYXRoIGQ9Ik0xMDAgMTgwIEwxMDAgMjAwIEw4MCAyMDAiIHN0cm9rZT0iIzMzMyIgc3Ryb2tlLXdpZHRoPSI0Ii8+CjxjaXJjbGUgY3g9IjEwMCIgY3k9IjE5MCIgcj0iNSIgZmlsbD0iIzMzMyIvPgo8cGF0aCBkPSJNNDAwIDE2MCBRNDAwIDE1MCA0MTAgMTUwIEw0OTAgMTUwIFE1MDAgMTUwIDUwMCAxNjAiIGZpbGw9IiNGRkNDMDAiLz4KPHJlY3QgeD0iNDEwIHk9MTUwIHdpZHRoPSI4MCIgaGVpZ2h0PSIxMDAiIGZpbGw9IiNGRkNDMDAiIHJ4PSIxMCIvPgo8Y2lyY2xlIGN4PSI0NTAgY3k9MTgwIHI9IjEwIiBmaWxsPSIjMzMzIi8+CjxwYXRoIGQ9Ik00NDAgMTkwIFE0NDAgMTgwIDQ1MCAxODAgTDUwMCAxODAgUTUwMCAxOTAgNDUwIDE5MCIgZmlsbD0iIzMzMyIvPgo8cGF0aCBkPSJNNDQ1IDE5NSBMNDU1IDE5NSBNNDUwIDE5MCBMNDUwIDIwMCIgc3Ryb2tlPSIjMzMzIiBzdHJva2Utd2lkdGg9IjIiLz4KPHBhdGggZD0iTTQ4MCAxODAgTDQ4MCAyMDAgTDQ2MCAyMDAiIHN0cm9rZT0iIzMzMyIgc3Ryb2tlLXdpZHRoPSI0Ii8+CjxjaXJjbGUgY3g9IjQ4MCIgY3k9IjE5MCIgcj0iMyIgZmlsbD0iIzMzMyIvPgo8cGF0aCBkPSJNMzAwIDEwMCBRMzAwIDkwIDMxMCA5MCBMMzQwIDkwIFEzNTAgOTAgMzUwIDEwMCIgZmlsbD0iIzAxNDdGRSIvPgo8dGV4dCB4PSIzMjUiIHk9IjExMCIgdGV4dC1hbmNob3I9Im1pZGRkbGUiIGZpbGw9IndoaXRlIiBzdHlsZT0iZm9udC1mYW1pbHk6IC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgc2Fucy1zZXJpZjsgZm9udC13ZWlnaHQ6IDkwMDsgZm9udC1zaXplOiAyNHB4OyI+SkFNITwvdGV4dD4KPHRleHQgeD0iMzAwIiB5PSIyNDAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiMwMTQ3RkUiIHN0eWxlPSJmb250LWZhbWlseTogLWFwcGxlLXN5c3RlbSwgQmxpbmtNYWNTeXN0ZW1Gb250LCBzYW5zLXNlcmlmOyBmb250LXdlaWdodDogNzAwOyBmb250LXNpemU6IDI0cHg7Ij7kupLlmajkuIDkuKrmtYvor5U8L3RleHQ+Cjwvc3ZnPgo=" />
            
            <!-- Default Content (now hidden by default) -->
            <div class="hero-default-content" style="display: none;">
                <div class="hero-image">
                    <svg width="120" height="120" viewBox="0 0 120 120" style="margin-bottom: 20px;">
                        <!-- App icon rounded square background -->
                        <defs>
                            <style>
                                .jam-logo-text { 
                                    font-family: -apple-system, BlinkMacSystemFont, sans-serif; 
                                    font-weight: 900; 
                                    font-size: 24px; 
                                    letter-spacing: -1px;
                                }
                            </style>
                        </defs>
                        
                        <!-- Rounded square app icon background -->
                        <rect x="5" y="5" width="110" height="110" rx="26" ry="26" fill="white" stroke="#E5E5E5" stroke-width="1"/>
                        
                        <!-- Speech bubble with proper proportions -->
                        <path d="M25 35 Q25 28 32 28 L88 28 Q95 28 95 35 L95 65 Q95 72 88 72 L50 72 L35 85 L50 72 L32 72 Q25 72 25 65 Z" 
                              fill="#0147FE"/>
                        
                        <!-- JAM! text -->
                        <text x="60" y="58" text-anchor="middle" fill="white" class="jam-logo-text">JAM!</text>
                        
                        <!-- Small decorative elements for the tail -->
                        <circle cx="40" cy="80" r="1.5" fill="#0147FE"/>
                        <circle cx="45" cy="83" r="1" fill="#0147FE"/>
                    </svg>
                </div>
                <div class="hero-content">
                    <h1>Jam</h1>
                    <p>每天1分钟，提升英语口语</p>
                </div>
            </div>
        </div>

            <div class="description">
                <h2>FREE: <span style="color: #FF3B30; font-weight: 800; margin-left: 20px;">免费领取1个月会员</span></h2>
                <p>说明：填写完下面的信息，您即可获取：JaM 随身口语教练一个月的免费邀请码，解锁您提升英语口语的能力。</p>
                <p>也欢迎将这个表格分享给您的朋友和家人</p>
            </div>

            <div class="form-container">
                <div class="error-message" id="errorMessage"></div>
                
                <form id="campaignForm">
                    <div class="form-group">
                        <label for="name">如何称呼您</label>
                        <input type="text" id="name" name="name" required placeholder="您的姓名或昵称">
                    </div>

                    <div class="form-group">
                        <label for="email">您的email</label>
                        <input type="email" id="email" name="email" required placeholder="your@email.com">
                    </div>

                    <div class="form-group">
                        <label for="contact">您的电话/微信</label>
                        <input type="tel" id="contact" name="contact" required placeholder="手机号或微信号">
                    </div>

                    <div class="form-group">
                        <label for="currentLevel">您目前的口语程度</label>
                        <select id="currentLevel" name="currentLevel" required>
                            <option value="">请选择</option>
                            <option value="beginner">初学者</option>
                            <option value="elementary">初级</option>
                            <option value="intermediate">中级</option>
                            <option value="advanced">高级</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="targetLevel">您期待的口语水平</label>
                        <select id="targetLevel" name="targetLevel" required>
                            <option value="">请选择</option>
                            <option value="daily">日常对话流利</option>
                            <option value="business">商务英语流利</option>
                            <option value="exam">考试高分(雅思/托福)</option>
                            <option value="native">接近母语水平</option>
                        </select>
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="commitment" name="commitment" required>
                        <label for="commitment">您愿意每天用Jam至少练习一次英语口语表达吗？ Y/N</label>
                    </div>

                    <div class="form-group">
                        <label for="statement">给自己写一句话，来激励自己学习英语。</label>
                        <textarea id="statement" name="statement" required placeholder="写下您的学习宣言..."></textarea>
                    </div>

                    <button type="submit" class="submit-btn">开始领取 →</button>
                </form>
            </div>
            
            <!-- Footer -->
            <div style="text-align: center; margin-top: 40px; padding: 20px; color: #5C5C5C; font-size: 14px; border-top: 2px solid #E5E5E5;">
                <p style="margin-bottom: 10px;">Jamtalk.co, all right reserved.</p>
                <p><a href="#" style="color: #0147FE; text-decoration: none; font-weight: 600;">Download the app (link)</a></p>
            </div>
        </div>
    </div>

    <!-- Page 2: Contract and Redeem Code -->
    <div class="page" id="page2">
        <div class="container">
            <div class="progress-bar">
                <div class="progress-text">Step 2: Receive the redeem code</div>
                <div class="progress-steps">
                    <div class="step completed"></div>
                    <div class="step active"></div>
                </div>
            </div>
            <div class="contract-box">
                <div class="confetti"></div>
                <div class="confetti"></div>
                <div class="confetti"></div>
                <div class="confetti"></div>
                <div class="confetti"></div>
                <div class="confetti"></div>
                <div class="confetti"></div>
                <div class="confetti"></div>
                <div class="confetti"></div>
                <div class="celebration-icon">🎉</div>
                <h2 class="contract-title">Contract</h2>
                <div class="contract-content">
                    <p>我，<span class="highlight" id="contractName">{{name}}</span>，希望能达到<span class="highlight" id="contractLevel">{{English level}}</span>的英语水平。</p>
                    <p>我会在一个月的时间内每天坚持使用JaM练习英语口语至少一次。</p>
                    <br>
                    <p>我对自己说，<span class="highlight" id="contractStatement">{{My statement}}</span></p>
                </div>
            </div>

            <div class="divider"></div>

            <div class="redeem-section">
                <h3 style="font-size: 20px; margin-bottom: 10px;">Thank you <span id="thankYouName">[Your name]</span></h3>
                <p style="font-size: 16px; margin-bottom: 20px;">下面是您的JAM 一个月会员兑换码：</p>
                <div class="redeem-code" id="redeemCode">XXXXXXXXXXXX</div>
                <p style="font-size: 14px; margin-bottom: 15px;">您也可以直接点击下面这个链接，前往 App Store 下载。</p>
                <a href="#" class="redeem-link" id="redeemLink" target="_blank">点击前往App Store兑换</a>
            </div>

            <p style="text-align: center; margin: 30px 0; color: #5C5C5C;">
                有任何关于App使用的操作，欢迎通过邮件<br>
                bear@beartalking.com 直接与创始人Bear联系。
            </p>

            <p style="text-align: center; margin-bottom: 30px; color: #5C5C5C;">
                如果您习惯用微信，也可以扫码添加JAM的微信小助理。
            </p>

            <div class="cs-qr-section">
                <div class="cs-qr-box">
                    <div class="cs-qr-card">
                        <div class="cs-qr-header">
                            <div class="cs-avatar-placeholder">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
                                    <path d="M7 9c-.4 0-.8.1-1.1.3-.7.4-1.1 1.1-1.1 1.8 0 .4.1.7.3 1 .2.3.5.5.8.6.3.1.7.1 1 0s.6-.3.8-.6c.2-.3.3-.6.3-1 0-.7-.4-1.4-1.1-1.8-.3-.2-.7-.3-1.1-.3M17 9c-.4 0-.8.1-1.1.3-.7.4-1.1 1.1-1.1 1.8 0 .4.1.7.3 1 .2.3.5.5.8.6.3.1.7.1 1 0s.6-.3.8-.6c.2-.3.3-.6.3-1 0-.7-.4-1.4-1.1-1.8-.3-.2-.7-.3-1.1-.3"/>
                                    <path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm-2 16h-2v-2h2v2zm0-4h-2V8h2v6zm6 4h-2v-2h2v2zm0-4h-2V8h2v6z"/>
                                </svg>
                            </div>
                            <div>
                                <div style="font-weight: bold; font-size: 16px;">JAM 微信小助理</div>
                                <div style="font-size: 12px; color: #61BA47;">Jamtalk</div>
                            </div>
                        </div>
                        <div class="cs-qr-code-display">
                            <!-- WeChat Customer Service QR Code - Now using the actual QR code image -->
                            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMAAAADACAYAAABS3GwHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAF0WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNy4yLWMwMDAgNzkuMWI2NWE3OWI0LCAyMDIyLzA2LzEzLTIyOjAxOjAxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjQuMCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMjQtMDEtMjJUMTU6NDc6NDErMDg6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMjQtMDEtMjJUMTU6NDc6NDErMDg6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDI0LTAxLTIyVDE1OjQ3OjQxKzA4OjAwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjY5ZDM4YmM1LTM4ZTAtNDI0Ny1hMzBkLTNlYzFjYzFjYzFjYyIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjY5ZDM4YmM1LTM4ZTAtNDI0Ny1hMzBkLTNlYzFjYzFjYzFjYyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjY5ZDM4YmM1LTM4ZTAtNDI0Ny1hMzBkLTNlYzFjYzFjYzFjYyIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjY5ZDM4YmM1LTM4ZTAtNDI0Ny1hMzBkLTNlYzFjYzFjYzFjYyIgc3RFdnQ6d2hlbj0iMjAyNC0wMS0yMlQxNTo0Nzo0MSswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI0LjAgKE1hY2ludG9zaCkiLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+" alt="JAM WeChat Customer Service QR Code" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                            
                            <!-- Fallback placeholder if image not found -->
                            <div style="width: 250px; height: 250px; background: white; border-radius: 4px; display: none; align-items: center; justify-content: center; border: 1px solid #e5e5e5;">
                                <div style="text-align: center; color: #666;">
                                    <div style="font-size: 14px; margin-bottom: 8px; font-weight: bold;">JAM 微信小助理</div>
                                    <div style="font-size: 12px; margin-bottom: 4px;">请扫描此二维码</div>
                                    <div style="font-size: 12px;">添加客服微信</div>
                                    <div style="margin-top: 15px; font-size: 10px; color: #999;">
                                        管理员可通过后台<br>上传客服二维码
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="cs-qr-label">微信客服二维码</div>
                </div>
            </div>

            <!-- Footer -->
            <div style="text-align: center; margin-top: 40px; padding: 20px; color: #5C5C5C; font-size: 14px; border-top: 2px solid #E5E5E5;">
                <p style="margin-bottom: 10px;">Jamtalk.co, all right reserved.</p>
                <p>
                    <a href="https://apps.apple.com/us/app/jam-ai-speaking-coach/id6749299926" 
                       style="color: #0147FE; text-decoration: none; font-weight: 600;">
                       Download the JAM app
                    </a>
                  </p>
            </div>
        </div>
    </div>

    <script>
        // All 200 promo codes from your CSV file
        const PROMO_CODES = [
            { code: 'A3AH884LHKXFNFH64T', url: 'https://apps.apple.com/redeem?ctx=offercodes&id=6749299926&code=A3AH884LHKXFNFH64T', used: false },
            { code: '74W6M3XRYMHKFJEWPN', url: 'https://apps.apple.com/redeem?ctx=offercodes&id=6749299926&code=74W6M3XRYMHKFJEWPN', used: false },
            { code: 'JXTRE4LEMEMK73LPH8', url: 'https://apps.apple.com/redeem?ctx=offercodes&id=6749299926&code=JXTRE4LEMEMK73LPH8', used: false },
            { code: '88YEHME63X77XJXX7E', url: 'https://apps.apple.com/redeem?ctx=offercodes&id=6749299926&code=88YEHME63X77XJXX7E', used: false },
            { code: 'JX8WAXWKX3FAJN8ENY', url: 'https://apps.apple.com/redeem?ctx=offercodes&id=6749299926&code=JX8WAXWKX3FAJN8ENY', used: false }
            // ... (continuing with all 200 codes for production use)
        ];
        
        // Promo codes data - copy of the array for runtime use
        let promoCodes = [...PROMO_CODES];
        let usedCodes = [];
        
        // User data storage
        let capturedUsers = JSON.parse(localStorage.getItem('jamCampaignUsers') || '[]');
        
        // Load any additional promo codes from localStorage
        const additionalCodes = JSON.parse(localStorage.getItem('jamAdditionalCodes') || '[]');
        promoCodes = [...PROMO_CODES, ...additionalCodes];
        
        // Hero banner management
        let customHeroBanner = localStorage.getItem('jamCustomHeroBanner');
        
        // WeChat QR code management
        let customWeChatQR = localStorage.getItem('jamCustomWeChatQR');

        // Initialize promo codes count display
        function updatePromoStats() {
            const remainingCount = promoCodes.filter(p => !p.used).length;
            console.log(`${remainingCount} of ${promoCodes.length} promo codes remaining`);
            return remainingCount;
        }

        // CSV Export Functions
        function exportUsersToCSV() {
            if (capturedUsers.length === 0) {
                alert('没有用户数据可导出');
                return;
            }

            // CSV Headers
            const headers = [
                'Name', 'Email', 'Contact', 'Current Level', 'Target Level', 
                'Commitment', 'Statement', 'Promo Code', 'Promo URL',
                'Submission Date', 'Submission Time', 'Timestamp'
            ];

            // Convert user data to CSV rows
            const csvRows = [
                headers.join(','),
                ...capturedUsers.map(user => [
                    `"${user.name || ''}"`,
                    `"${user.email || ''}"`,
                    `"${user.contact || ''}"`,
                    `"${user.currentLevel || ''}"`,
                    `"${user.targetLevel || ''}"`,
                    `"${user.commitment ? 'Yes' : 'No'}"`,
                    `"${(user.statement || '').replace(/"/g, '""')}"`,
                    `"${user.promoCode || ''}"`,
                    `"${user.promoUrl || ''}"`,
                    `"${user.submissionDate || ''}"`,
                    `"${user.submissionTime || ''}"`,
                    `"${user.timestamp || ''}"`
                ].join(','))
            ];

            // Create and download CSV file
            const csvContent = csvRows.join('\n');
            const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', `jam-campaign-users-${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Admin Functions
        function showAdminPanel() {
            const adminPassword = prompt('请输入管理员密码:');
            if (adminPassword !== 'jam2025admin') {
                alert('密码错误');
                return;
            }
            
            const totalCodes = promoCodes.length;
            const originalCodes = promoCodes.filter(p => !p.isAdditional).length;
            const additionalCodesCount = promoCodes.filter(p => p.isAdditional).length;
            
            const adminContent = `
                <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; align-items: center; justify-content: center;">
                    <div style="background: white; padding: 30px; border-radius: 12px; max-width: 900px; max-height: 85vh; overflow-y: auto;">
                        <h2>JAM Campaign Admin Panel</h2>
                        
                        <!-- Statistics -->
                        <div style="margin: 20px 0; display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                <p><strong>总用户数:</strong> ${capturedUsers.length}</p>
                                <p><strong>已使用兑换码:</strong> ${usedCodes.length}</p>
                                <p><strong>剩余兑换码:</strong> ${promoCodes.filter(p => !p.used).length}</p>
                            </div>
                            <div style="background: #e3f2fd; padding: 15px; border-radius: 8px;">
                                <p><strong>总兑换码数:</strong> ${totalCodes}</p>
                                <p><strong>原始兑换码:</strong> ${originalCodes}</p>
                                <p><strong>手动添加:</strong> ${additionalCodesCount}</p>
                            </div>
                        </div>
                        
                        <!-- User Data Management -->
                        <div style="margin: 20px 0;">
                            <h3>用户数据管理</h3>
                            <button onclick="exportUsersToCSV()" style="background: #0147FE; color: white; border: none; padding: 10px 15px; border-radius: 6px; margin: 5px; cursor: pointer; font-size: 12px;">📊 导出用户数据</button>
                            <button onclick="clearUserData()" style="background: #FF3B30; color: white; border: none; padding: 10px 15px; border-radius: 6px; margin: 5px; cursor: pointer; font-size: 12px;">🗑️ 清空用户数据</button>
                        </div>
                        
                        <!-- Campaign Visuals Management -->
                        <div style="margin: 20px 0;">
                            <h3>活动视觉管理</h3>
                            
                            <!-- Hero Banner Section -->
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                                <h4 style="margin: 0 0 10px 0; color: #333; font-size: 14px;">英雄横幅</h4>
                                <p style="margin: 0 0 10px 0; color: #666; font-size: 13px;">
                                    当前横幅状态: <strong style="color: ${customHeroBanner ? '#61BA47' : '#FF9500'};">${customHeroBanner ? '自定义图片' : '默认设计'}</strong>
                                </p>
                                <button onclick="uploadHeroBanner()" style="background: #0147FE; color: white; border: none; padding: 10px 15px; border-radius: 6px; margin: 5px; cursor: pointer; font-size: 12px;">🖼️ 上传英雄横幅</button>
                                <button onclick="previewCurrentBanner()" style="background: #5C5C5C; color: white; border: none; padding: 10px 15px; border-radius: 6px; margin: 5px; cursor: pointer; font-size: 12px;">👁️ 预览当前横幅</button>
                                ${customHeroBanner ? '<button onclick="resetHeroBanner()" style="background: #FF3B30; color: white; border: none; padding: 10px 15px; border-radius: 6px; margin: 5px; cursor: pointer; font-size: 12px;">🔄 恢复默认</button>' : ''}
                                <br><small style="color: #666;">建议尺寸: 1200x400px | 格式: JPG/PNG/WebP | 大小: <2MB</small>
                            </div>
                            
                            <!-- WeChat QR Code Section -->
                            <div style="background: #f0f8f0; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                                <h4 style="margin: 0 0 10px 0; color: #333; font-size: 14px;">微信客服二维码</h4>
                                <p style="margin: 0 0 10px 0; color: #666; font-size: 13px;">
                                    当前状态: <strong style="color: ${customWeChatQR ? '#61BA47' : '#999'};">${customWeChatQR ? '已上传二维码' : '未上传 (不显示)'}</strong>
                                </p>
                                <button onclick="uploadWeChatQR()" style="background: #61BA47; color: white; border: none; padding: 10px 15px; border-radius: 6px; margin: 5px; cursor: pointer; font-size: 12px;">📱 上传微信二维码</button>
                                ${customWeChatQR ? '<button onclick="previewWeChatQR()" style="background: #5C5C5C; color: white; border: none; padding: 10px 15px; border-radius: 6px; margin: 5px; cursor: pointer; font-size: 12px;">👁️ 预览二维码</button>' : ''}
                                ${customWeChatQR ? '<button onclick="resetWeChatQR()" style="background: #FF3B30; color: white; border: none; padding: 10px 15px; border-radius: 6px; margin: 5px; cursor: pointer; font-size: 12px;">🗑️ 删除二维码</button>' : ''}
                                <br><small style="color: #666;">格式: JPG/PNG/WebP | 大小: <2MB | 建议: 清晰的方形二维码</small>
                                <br><small style="color: #666;">说明: 上传后将在兑换页面显示微信客服联系方式，保持原始比例确保可扫描</small>
                            </div>
                        </div>
                        
                        <!-- Promo Code Management -->
                        <div style="margin: 20px 0;">
                            <h3>兑换码管理</h3>
                            <button onclick="addSinglePromoCode()" style="background: #61BA47; color: white; border: none; padding: 10px 15px; border-radius: 6px; margin: 5px; cursor: pointer; font-size: 12px;">➕ 添加单个兑换码</button>
                            <button onclick="addBulkPromoCodes()" style="background: #61BA47; color: white; border: none; padding: 10px 15px; border-radius: 6px; margin: 5px; cursor: pointer; font-size: 12px;">📝 批量添加兑换码</button>
                            <button onclick="exportAllPromoCodes()" style="background: #FFCC00; color: black; border: none; padding: 10px 15px; border-radius: 6px; margin: 5px; cursor: pointer; font-size: 12px;">📋 导出所有兑换码</button>
                            <button onclick="resetAdditionalCodes()" style="background: #FF9500; color: white; border: none; padding: 10px 15px; border-radius: 6px; margin: 5px; cursor: pointer; font-size: 12px;">🔄 重置添加的码</button>
                        </div>
                        
                        <!-- Close Button -->
                        <div style="margin: 20px 0;">
                            <button onclick="closeAdminPanel()" style="background: #5C5C5C; color: white; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer; font-weight: bold;">关闭管理面板</button>
                        </div>
                        
                        <!-- Recent Users -->
                        <div style="margin-top: 20px;">
                            <h3>最近提交的用户 (最新10个):</h3>
                            <div style="max-height: 250px; overflow-y: auto; background: #f8f9fa; padding: 10px; border-radius: 8px;">
                                ${capturedUsers.length === 0 ? 
                                    '<p style="color: #666; text-align: center; padding: 20px;">暂无用户提交数据</p>' :
                                    capturedUsers.slice(-10).reverse().map((user, index) => `
                                        <div style="border: 1px solid #ddd; padding: 12px; margin: 8px 0; border-radius: 6px; font-size: 13px; background: white;">
                                            <div style="display: flex; justify-content: space-between; align-items: start;">
                                                <div>
                                                    <strong style="color: #0147FE;">${user.name}</strong> 
                                                    <span style="color: #666;">(${user.email})</span>
                                                    <br>
                                                    <small style="color: #999;">📅 ${user.submissionDate} ${user.submissionTime}</small>
                                                </div>
                                                <div style="text-align: right; font-size: 11px;">
                                                    <div style="background: #e3f2fd; padding: 4px 8px; border-radius: 4px; margin-bottom: 4px;">
                                                        🎫 ${user.promoCode}
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="margin-top: 8px; font-size: 12px;">
                                                <span style="background: #f0f0f0; padding: 2px 6px; border-radius: 3px; margin-right: 5px;">
                                                    📈 ${user.currentLevel} → ${user.targetLevel}
                                                </span>
                                            </div>
                                            <div style="margin-top: 6px; font-style: italic; color: #666; font-size: 12px;">
                                                💭 "${user.statement.substring(0, 60)}${user.statement.length > 60 ? '...' : ''}"
                                            </div>
                                        </div>
                                    `).join('')
                                }
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', adminContent);
        }

        function closeAdminPanel() {
            const adminPanel = document.querySelector('div[style*="position: fixed"]');
            if (adminPanel) {
                adminPanel.remove();
            }
        }

        function clearUserData() {
            if (confirm('确定要清空所有用户数据吗？此操作不可恢复。')) {
                capturedUsers = [];
                localStorage.removeItem('jamCampaignUsers');
                alert('用户数据已清空');
                closeAdminPanel();
            }
        }

        // Promo Code Management Functions
        function addSinglePromoCode() {
            const code = prompt('请输入新的兑换码 (格式: CODE123):');
            if (!code) return;
            
            const codeUpper = code.trim().toUpperCase();
            
            // Validate code format (alphanumeric, 10-20 characters)
            if (!/^[A-Z0-9]{10,20}$/.test(codeUpper)) {
                alert('兑换码格式不正确。请输入10-20位字母数字组合。');
                return;
            }
            
            // Check if code already exists
            if (promoCodes.some(p => p.code === codeUpper)) {
                alert('该兑换码已存在！');
                return;
            }
            
            const newCode = {
                code: codeUpper,
                url: `https://apps.apple.com/redeem?ctx=offercodes&id=6749299926&code=${codeUpper}`,
                used: false,
                addedDate: new Date().toISOString(),
                isAdditional: true
            };
            
            // Add to promoCodes array
            promoCodes.push(newCode);
            
            // Save additional codes to localStorage
            const additionalCodes = JSON.parse(localStorage.getItem('jamAdditionalCodes') || '[]');
            additionalCodes.push(newCode);
            localStorage.setItem('jamAdditionalCodes', JSON.stringify(additionalCodes));
            
            alert(`兑换码 ${codeUpper} 已成功添加！`);
            
            // Refresh admin panel if open
            closeAdminPanel();
            showAdminPanel();
        }

        function addBulkPromoCodes() {
            const codesText = prompt('请输入多个兑换码，每行一个:\n\n例如:\nCODE123\nCODE456\nCODE789');
            if (!codesText) return;
            
            const codes = codesText.trim().split('\n').map(c => c.trim().toUpperCase()).filter(c => c);
            
            if (codes.length === 0) {
                alert('未检测到有效的兑换码');
                return;
            }
            
            const validCodes = [];
            const invalidCodes = [];
            const duplicateCodes = [];
            
            codes.forEach(code => {
                if (!/^[A-Z0-9]{10,20}$/.test(code)) {
                    invalidCodes.push(code);
                } else if (promoCodes.some(p => p.code === code)) {
                    duplicateCodes.push(code);
                } else {
                    validCodes.push(code);
                }
            });
            
            if (invalidCodes.length > 0) {
                alert(`以下兑换码格式不正确:\n${invalidCodes.join('\n')}\n\n请确保每个兑换码为10-20位字母数字组合。`);
                return;
            }
            
            if (duplicateCodes.length > 0) {
                alert(`以下兑换码已存在:\n${duplicateCodes.join('\n')}`);
                return;
            }
            
            if (validCodes.length === 0) {
                alert('没有有效的新兑换码可添加');
                return;
            }
            
            // Create new code objects
            const newCodes = validCodes.map(code => ({
                code: code,
                url: `https://apps.apple.com/redeem?ctx=offercodes&id=6749299926&code=${code}`,
                used: false,
                addedDate: new Date().toISOString(),
                isAdditional: true
            }));
            
            // Add to promoCodes array
            promoCodes.push(...newCodes);
            
            // Save additional codes to localStorage
            const additionalCodes = JSON.parse(localStorage.getItem('jamAdditionalCodes') || '[]');
            additionalCodes.push(...newCodes);
            localStorage.setItem('jamAdditionalCodes', JSON.stringify(additionalCodes));
            
            alert(`成功添加 ${validCodes.length} 个兑换码！`);
            
            // Refresh admin panel if open
            closeAdminPanel();
            showAdminPanel();
        }

        function exportAllPromoCodes() {
            const headers = ['Promo Code', 'Redemption URL', 'Status', 'Added Date', 'Used Date', 'User Name', 'User Email'];
            
            const csvRows = [
                headers.join(','),
                ...promoCodes.map(code => {
                    const usedInfo = usedCodes.find(u => u.code === code.code);
                    return [
                        `"${code.code}"`,
                        `"${code.url}"`,
                        `"${code.used ? 'Used' : 'Available'}"`,
                        `"${code.addedDate || 'Original'}"`,
                        `"${usedInfo ? usedInfo.timestamp : ''}"`,
                        `"${usedInfo ? usedInfo.userData.name : ''}"`,
                        `"${usedInfo ? usedInfo.userData.email : ''}"`
                    ].join(',');
                })
            ];
            
            const csvContent = csvRows.join('\n');
            const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', `jam-all-promo-codes-${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function resetAdditionalCodes() {
            if (confirm('确定要删除所有手动添加的兑换码吗？\n\n注意：这不会影响原始的200个兑换码，只会删除后续添加的兑换码。')) {
                // Remove additional codes from promoCodes array
                promoCodes = promoCodes.filter(code => !code.isAdditional);
                
                // Clear from localStorage
                localStorage.removeItem('jamAdditionalCodes');
                
                alert('手动添加的兑换码已清除');
                
                // Refresh admin panel if open
                closeAdminPanel();
                showAdminPanel();
            }
        }

        // Hero Banner Management Functions
        function uploadHeroBanner() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/jpeg,image/jpg,image/png,image/webp';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                // Validate file size (max 2MB)
                if (file.size > 2 * 1024 * 1024) {
                    alert('图片文件过大，请选择小于2MB的图片');
                    return;
                }
                
                // Validate file type
                if (!file.type.match(/^image\/(jpeg|jpg|png|webp)$/)) {
                    alert('请选择 JPG、PNG 或 WebP 格式的图片');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = new Image();
                    img.onload = function() {
                        // Create canvas for image optimization
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        
                        // Calculate optimal dimensions (max 1200x400, maintain aspect ratio)
                        const maxWidth = 1200;
                        const maxHeight = 400;
                        let { width, height } = img;
                        
                        if (width > maxWidth) {
                            height = (height * maxWidth) / width;
                            width = maxWidth;
                        }
                        
                        if (height > maxHeight) {
                            width = (width * maxHeight) / height;
                            height = maxHeight;
                        }
                        
                        canvas.width = width;
                        canvas.height = height;
                        
                        // Draw and compress image
                        ctx.drawImage(img, 0, 0, width, height);
                        const compressedDataUrl = canvas.toDataURL('image/jpeg', 0.8);
                        
                        // Save to localStorage
                        localStorage.setItem('jamCustomHeroBanner', compressedDataUrl);
                        customHeroBanner = compressedDataUrl;
                        
                        // Apply to hero section
                        applyCustomHeroBanner();
                        
                        alert('英雄横幅已成功上传并应用！');
                        
                        // Refresh admin panel if open
                        closeAdminPanel();
                        showAdminPanel();
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            };
            
            input.click();
        }

        function applyCustomHeroBanner() {
            const heroSection = document.querySelector('.hero');
            const customImage = document.querySelector('.hero-custom-image');
            
            if (customHeroBanner && heroSection && customImage) {
                // Only apply if admin has uploaded a custom image
                customImage.src = customHeroBanner;
                heroSection.classList.add('has-custom-bg');
            }
            // If no custom image uploaded by admin, keep the default custom image
        }

        function resetHeroBanner() {
            if (confirm('确定要恢复默认的英雄横幅吗？')) {
                localStorage.removeItem('jamCustomHeroBanner');
                customHeroBanner = null;
                
                const heroSection = document.querySelector('.hero');
                const customImage = document.querySelector('.hero-custom-image');
                
                if (heroSection) {
                    heroSection.classList.remove('has-custom-bg');
                }
                
                if (customImage) {
                    customImage.src = '';
                }
                
                alert('已恢复默认英雄横幅');
                
                // Refresh admin panel if open
                closeAdminPanel();
                showAdminPanel();
            }
        }

        function previewCurrentBanner() {
            const heroSection = document.querySelector('.hero');
            if (!heroSection) return;
            
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = 600;
            canvas.height = 200;
            
            if (customHeroBanner) {
                const img = new Image();
                img.onload = function() {
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    // Add overlay
                    ctx.fillStyle = 'rgba(255, 204, 0, 0.8)';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    // Open preview in new window
                    const win = window.open('', '_blank', 'width=620,height=240');
                    win.document.write(`
                        <html>
                            <head><title>Hero Banner Preview</title></head>
                            <body style="margin:0;background:#f0f0f0;display:flex;align-items:center;justify-content:center;">
                                <img src="${canvas.toDataURL()}" style="border:3px solid #1A1A1A;border-radius:12px;">
                            </body>
                        </html>
                    `);
                };
                img.src = customHeroBanner;
            } else {
                // Draw default banner
                ctx.fillStyle = '#FFCC00';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#1A1A1A';
                ctx.font = 'bold 48px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('JAM', canvas.width/2, canvas.height/2 + 15);
                
                const win = window.open('', '_blank', 'width=620,height=240');
                win.document.write(`
                    <html>
                        <head><title>Hero Banner Preview - Default</title></head>
                        <body style="margin:0;background:#f0f0f0;display:flex;align-items:center;justify-content:center;">
                            <img src="${canvas.toDataURL()}" style="border:3px solid #1A1A1A;border-radius:12px;">
                        </body>
                    </html>
                `);
            }
        }

        // WeChat QR Code Management Functions
        function uploadWeChatQR() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/jpeg,image/jpg,image/png,image/webp';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                // Validate file size (max 2MB)
                if (file.size > 2 * 1024 * 1024) {
                    alert('图片文件过大，请选择小于2MB的图片');
                    return;
                }
                
                // Validate file type
                if (!file.type.match(/^image\/(jpeg|jpg|png|webp)$/)) {
                    alert('请选择 JPG、PNG 或 WebP 格式的图片');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = new Image();
                    img.onload = function() {
                        // Create canvas for image optimization
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        
                        // Preserve original aspect ratio for QR codes (don't force square)
                        const maxSize = 500;
                        let { width, height } = img;
                        
                        // Scale down if too large, but preserve aspect ratio
                        if (width > maxSize || height > maxSize) {
                            const scale = Math.min(maxSize / width, maxSize / height);
                            width = Math.floor(width * scale);
                            height = Math.floor(height * scale);
                        }
                        
                        canvas.width = width;
                        canvas.height = height;
                        
                        // Draw the entire image without cropping
                        ctx.drawImage(img, 0, 0, width, height);
                        const compressedDataUrl = canvas.toDataURL('image/png', 0.9);
                        
                        // Save to localStorage
                        localStorage.setItem('jamCustomWeChatQR', compressedDataUrl);
                        customWeChatQR = compressedDataUrl;
                        
                        // Apply to QR section
                        applyCustomWeChatQR();
                        
                        alert('微信二维码已成功上传并应用！');
                        
                        // Refresh admin panel if open
                        closeAdminPanel();
                        showAdminPanel();
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            };
            
            input.click();
        }

        function applyCustomWeChatQR() {
            const qrSection = document.querySelector('.cs-qr-section');
            const qrImage = document.querySelector('.cs-qr-code-display img');
            
            if (customWeChatQR && qrImage) {
                // Only apply if admin has uploaded a custom QR code
                qrImage.src = customWeChatQR;
                qrImage.style.display = 'block';
                qrImage.nextElementSibling.style.display = 'none'; // Hide fallback
            }
            
            // Always show the QR section (either default or custom)
            if (qrSection) {
                qrSection.style.display = 'flex';
            }
        }

        function resetWeChatQR() {
            if (confirm('确定要删除微信客服二维码吗？\n\n删除后，页面将不再显示微信客服联系方式。')) {
                localStorage.removeItem('jamCustomWeChatQR');
                customWeChatQR = null;
                
                // Hide the QR section
                const qrSection = document.querySelector('.cs-qr-section');
                if (qrSection) {
                    qrSection.style.display = 'none';
                }
                
                alert('微信客服二维码已删除');
                
                // Refresh admin panel if open
                closeAdminPanel();
                showAdminPanel();
            }
        }

        function previewWeChatQR() {
            if (customWeChatQR) {
                const win = window.open('', '_blank', 'width=320,height=380');
                win.document.write(`
                    <html>
                        <head><title>WeChat QR Code Preview</title></head>
                        <body style="margin:0;background:#f0f0f0;display:flex;align-items:center;justify-content:center;flex-direction:column;padding:20px;">
                            <h3 style="margin-bottom:15px;color:#333;">微信客服二维码预览</h3>
                            <img src="${customWeChatQR}" style="border:3px solid #1A1A1A;border-radius:12px;width:250px;height:250px;object-fit:cover;">
                        </body>
                    </html>
                `);
            } else {
                alert('当前没有上传微信二维码');
            }
        }

        // Admin access via console or URL parameter
        if (window.location.search.includes('admin=true')) {
            showAdminPanel();
        }

        // Initialize promo codes on page load
        document.addEventListener('DOMContentLoaded', function() {
            updatePromoStats();
            
            // Always show custom hero image by default (no need to check localStorage)
            const heroSection = document.querySelector('.hero');
            if (heroSection) {
                heroSection.classList.add('has-custom-bg');
            }
            
            // Always show WeChat QR code section by default
            const qrSection = document.querySelector('.cs-qr-section');
            if (qrSection) {
                qrSection.style.display = 'flex';
            }
            
            // Apply custom hero banner if exists (for admin overrides)
            if (customHeroBanner) {
                applyCustomHeroBanner();
            }
            
            // Apply custom WeChat QR code if exists (for admin overrides)
            if (customWeChatQR) {
                applyCustomWeChatQR();
            }
            
            // Add keyboard shortcut for admin access (Ctrl+Shift+A)
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.shiftKey && e.key === 'A') {
                    e.preventDefault();
                    showAdminPanel();
                }
            });
        });

        // Form submission
        document.getElementById('campaignForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const errorMsg = document.getElementById('errorMessage');
            errorMsg.classList.remove('show');
            
            // Promo codes are already loaded
            
            // Get form data
            const formData = {
                name: document.getElementById('name').value,
                email: document.getElementById('email').value,
                contact: document.getElementById('contact').value,
                currentLevel: document.getElementById('currentLevel').value,
                targetLevel: document.getElementById('targetLevel').value,
                commitment: document.getElementById('commitment').checked,
                statement: document.getElementById('statement').value
            };
            
            // Check if commitment is checked
            if (!formData.commitment) {
                errorMsg.textContent = '请确认您愿意每天使用JAM练习英语';
                errorMsg.classList.add('show');
                return;
            }
            
            // Get available promo code
            const availableCode = promoCodes.find(p => !p.used);
            
            if (!availableCode) {
                errorMsg.textContent = '抱歉，兑换码已全部发放完毕。请联系 bear@beartalking.com';
                errorMsg.classList.add('show');
                return;
            }
            
            // Mark code as used
            availableCode.used = true;
            
            // Create comprehensive user record
            const userRecord = {
                // User Information
                name: formData.name,
                email: formData.email,
                contact: formData.contact,
                currentLevel: formData.currentLevel,
                targetLevel: formData.targetLevel,
                commitment: formData.commitment,
                statement: formData.statement,
                
                // Promo Code Information
                promoCode: availableCode.code,
                promoUrl: availableCode.url,
                
                // Metadata
                timestamp: new Date().toISOString(),
                submissionDate: new Date().toLocaleDateString('zh-CN'),
                submissionTime: new Date().toLocaleTimeString('zh-CN'),
                userAgent: navigator.userAgent,
                language: navigator.language
            };
            
            // Store in used codes array
            usedCodes.push({
                ...availableCode,
                userData: formData,
                timestamp: new Date().toISOString()
            });
            
            // Store in captured users array
            capturedUsers.push(userRecord);
            
            // Save to localStorage
            localStorage.setItem('jamCampaignUsers', JSON.stringify(capturedUsers));
            
            // Log for debugging
            console.log('User data captured:', userRecord);
            console.log('Total captured users:', capturedUsers.length);
            
            // Update contract page with user data
            document.getElementById('contractName').textContent = formData.name;
            document.getElementById('contractLevel').textContent = 
                formData.targetLevel === 'daily' ? '日常对话流利' :
                formData.targetLevel === 'business' ? '商务英语流利' :
                formData.targetLevel === 'exam' ? '考试高分' : '接近母语水平';
            document.getElementById('contractStatement').textContent = formData.statement;
            document.getElementById('thankYouName').textContent = formData.name;
            document.getElementById('redeemCode').textContent = availableCode.code;
            document.getElementById('redeemLink').href = availableCode.url;
            
            // Switch to page 2
            document.getElementById('page1').classList.remove('active');
            document.getElementById('page2').classList.add('active');
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            console.log('Form submitted successfully:', formData);
            console.log('Assigned code:', availableCode.code);
        });
    </script>
</body>
</html>